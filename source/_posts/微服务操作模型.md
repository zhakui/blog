---
title: 微服务操作模型
date: 2017-06-11 17:28:43
categories:
  Microservices
tags: 
  - Microservices
---

这里不仅仅是再次重复介绍一次微服务，有关微服务的介绍可以参考[Fowler - Microservices](http://martinfowler.com/articles/microservices.htmlFowler-Microservices).相反，这篇文章是基于我们已经开始使用微服务来分解我们的应用程序以期提高我们的应用的可部署下和可伸缩性。
当在系统环境中部署的微服务数量增加，单体式应用程序部署减少时，将遇到新的挑战，本文将重点关注这些新的挑战，并为使用大量微服务部署的系统环境定义操作模型。

本文将分为下面几个部分：
1. 前提条件
2. 扩大
3. 问题
4. 必须的组件
5. 参考模型

# 1 前提条件
首先，在系统环境中使用大量微服务需要什么？
更具Fowler的博客中介绍，这是我们想要实现的目标：
![](./microservices-1.png)
Source: （http://martinfowler.com/articles/microservices.html)
但是，我们在我们的系统环境中大量使用微服务取代我们的单体式应用程序之前，需要满足一些先决条件（部分可能不是许）：
- 目标架构
- 一个持续的交付工具链
- 一个适当的组织

## 1.1 目标架构
首先，我们需要思考，我们如何划分所有微服务。例如我们可以在某些层中垂直划分我们的微服务：
- '核心服务'：处理业务数据的持久性并应用业务规则和其他逻辑
- '组合服务'：组合服务可以协调许多核心服务以执行常见任务或聚合来自多个核心服务的信息。
- 'API服务'：暴露允许外部使用的功能，例如：在系统环境中使用的第三方提供的基础功能。

...横向，我们可以通过定义不同的域，然后根据不同的域进行分区。可形成类似下面的目标架构。
![](./microservices-architecture.png)
Note：这只是一个示例目标架构，您的架构可以完全不同。 这里的关键是，在开始扩展部署微服务之前，需要建立目标体系结构。 否则，您可能最终会进入一个看起来像一大碗意大利面条的系统环境（混乱不堪），其特性甚至比现有的单片应用程序更差。

## 1.2 持续的交付
我们还假设我们拥有某种连续交付工具链，以便我们能够以有效的可重复和质量驱动的方式推出我们的微服务，例如：
![](./microservices-1-2.png)
Source:（http://www.infoq.com/minibooks/emag-devops-toolchain)

## 1.3 组织
最后，我们假设我们采用我们的组织来避免康威定律的问题。 康威的法律规定：
> Any organization that designs a system (defined broadly) will produce a design whose structure is a copy of the organization’s communication structure. 

![](./microservices-1-1.png)
Source: (http://martinfowler.com/articles/microservices.html)

# 2 扩大
现在,提出本文关注的内容：
> 当我们开始拆分一些单片应用程序并用大量微服务替换它们时，系统环境会发生什么？
